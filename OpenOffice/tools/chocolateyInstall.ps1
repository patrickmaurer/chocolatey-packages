$packageName = 'OpenOffice'
$installerType = 'EXE'
$url = 'https://downloads.sourceforge.net/project/openofficeorg.mirror/4.1.8/binaries/en-US/Apache_OpenOffice_4.1.8_Win_x86_install_en-US.exe'
$checksumType = 'sha256'
$silentArgs = '/S'
$validExitCodes = @(0)

Write-Debug "Detecting Locale..."
$supportedLocales = @{
	'ast'   = 'D416158E1431057E1C1CC7442D72F2CE271ECD4843AECE6674116CD1B8CE6411';
	'bg'    = 'E2BB06EC641D199762C901F10E65505691E2F5CFDF590519F152C1D4994CBEF8';
	'ca'    = '3E864CE0B6B1861DC17D95873C752DB2D1A2654753AC70CACA12828CF2BED054';
	'ca-XR' = '86930D183B776E9EA5607E37FA65F5BDB5FE3433328F58F884C7FBB90B844DD3';
	'ca-XV' = 'F3BC43E0E977532D3912D019DC84CEB808BEDE994578589E6D5D34863502647F';
	'cs'    = '8B5A5BFCE4EA9A9206A4BCD6BD9833986CB914F3D9D1B69FC43AB8C329645564';
	'da'    = '87BE98ACAB8AC4AE7E2F0F52EB09C2ACF6120049E3B5FB1C896CAF06366CE6D5';
	'de'    = '0F606FFF22A6DBC60E862A3189006FE11D61E83BA35309C82DBD7FC9B9969E25';
	'el'    = 'BDE36E7F3787AFC7AF0F0386B30F868FB7E35156D40B6DFD240D18326DB11200';
	'en-GB' = '0044C4BA3EDE636824F0F24D603024694802FD9C880865DA871B7852D4E37DDF';
	'en-US' = 'C409A69B18924F9FBC77E8085D0E0F6EE7EB2BDACD5DE6234F6056622B09DD9F';
	'es'    = '845D3054E26772C7307533FA6CEE68EAF72DE9AB7A0BC7B4F48CD5005CDB67B6';
	'eu'    = '7507C0EF39B1E9A8CBA8F026DB6F521C564220991106B6DFEF07BCB62AEAE500';
	'fi'    = '76F968E011A475ED784E95968ACFD6470BABE8BDBD28CD2116693E669649A955';
	'fr'    = '4CD97CCF88C7ACC5591A2B023982826AA5585AC9CD12224C3D4A78E3EDB3E1E7';
	'gd'    = '54768BFDFE095726F24706B6506D475115D62617078391B754C888D5F34F72B4';
	'gl'    = '5F4EE82BC2A33C58D8E1FB9CF1DB37F3EF64C79F6ACC9C0AEF4B150D1DECDF68';
	'he'    = '7CF500B0944F40E36C53535EDFD6FFC149EB2CB90E891D796B18C507B1F7080A';
	'hi'    = '84491E058E6224E00AB7261394E12F9A74F13D34E41EC6327018CE34D8973F3C';
	'hu'    = '3791AB291986102E85B7F2485F453D8F221EE54B6ADB6AD0DDDD2BA8D1F1AAC9';
	'it'    = 'AB8E88442B737B2F34E5FC5CCD6A2D0D4F62EA9CE5320875DAF115DC0F9597B9';
	'ja'    = '1BAEDB0781B3267C6BE6207023EE7892A08BA02009806FABBF776EE0D79A2806';
	'km'    = 'EAAA8B13A2509B342DB727D7023CC7AF9593463DD56E3D2B3E367BFA12DAEEF9';
	'ko'    = '5C86E537C4D9B69ED81AC98B6EAC38DFBBC313123374C424033726D84C0D59CC';
	'lt'    = 'E1510950BB0A49D5A755C2EAA2D1986F5EDC4B45BA1685AD8D0866F146C1C1D9';
	'nb'    = 'AE7E3E7872362EA8C0F2B7987D58BC83B688486C0A083DA53348D0F90CDAB3FB';
	'nl'    = 'D09A5C35795D8BD76CE3008843A2E6A71CE77E9DA4E97B20D104A82DD0F3A58E';
	'pl'    = 'D00FDDFB5C30835D9581C1C69759DB12B52EE3E4A84513F5A7F2105C231F95E2';
	'pt'    = '817F641A7B877A612EAF171E6B1CC57B77BA8D96F541F20183B667DB130E97A6';
	'pt-BR' = 'C67291A2E6AE4306BF3BFEA5E6BB722F11330DBE001CB2E030D553EF2C848022';
	'ru'    = 'F2221B22B1F20BBA3EDE9330085ACC7861FD8FD9E98DD2FCA05888C3C1E9D6DC';
	'sk'    = '074E0812713EF9486BBF81EB98C30B5C50CA9EB06D68D4F9E3F1D781E14F4830';
	'sl'    = 'C8B28DDA581C223BB7484D350B6B1B00086444D672DBC3E6AB4642D1ABFAE9CD';
	'sr'    = '41FC8D9C8431B38E6B1F88B1B2222B248EC55CC29A36ABF0F12E1F8A6FC3626D';
	'sv'    = 'BED4F15C4D41A9F87598F7D675529F0E6AA9E9BAD4AF0311E091A638B6AE4DAE';
	'ta'    = 'E3F4AF012D33CDF5D1CDC56385B8061FA771A2A6CD4FB8AFE81A272E4CBF5D15';
	'th'    = 'C7A924FD642A138D8C79CB5399A168459DCE96D67438AD76CE600B61897FF7A8';
	'tr'    = 'E4905E584AE72FD6285FB56F0B6876E725DE6AF3C91D75D544C4D1401647D612';
	'vi'    = '402C5CBF00ED683332DD8BE394B118001B5A45F7CB319446F4E705EDF13FB8D7';
	'zh-CN' = '3978C5591F0A5AF51B1B412EC739B8627E1209115A194E322218C8EF5E29B209';
	'zh-TW' = 'D565370A519A592C3ABCAF53D2C9293429125054AF99C13F649DDAEC29D5F9DD'
}

$pp = Get-PackageParameters
$locale = $pp["locale"]
if ($locale -ne $null -and $locale -ne '' -and $supportedLocales.ContainsKey($locale)) {
	Write-Host "Switching to $locale"
	$url = $url -replace 'en-US', $locale
	$checksum = $supportedLocales[$locale]
} else {
	$locale = (Get-Culture).Name
	if ($supportedLocales.ContainsKey($locale)) {
		Write-Host "Switching to $locale"
		$url = $url -replace 'en-US', $locale
		$checksum = $supportedLocales[$locale]
	} else {
		$locale = (Get-Culture).TwoLetterISOLanguageName
		if ($supportedLocales.ContainsKey($locale)) {
			Write-Host "Switching to $locale"
			$url = $url -replace 'en-US', $locale
			$checksum = $supportedLocales[$locale]
		} else {
			Write-Debug "Using default $locale"
			$checksum = $supportedLocales['en-US']
		}
	}
}

Install-ChocolateyPackage "$packageName" "$installerType" "$silentArgs" "$url" -checksumType $checksumType -checksum $checksum -validExitCodes $validExitCodes