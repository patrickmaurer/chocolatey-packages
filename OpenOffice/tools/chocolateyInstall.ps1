$packageName = 'OpenOffice'
$installerType = 'EXE'
$url = 'https://downloads.sourceforge.net/project/openofficeorg.mirror/4.1.9/binaries/en-US/Apache_OpenOffice_4.1.9_Win_x86_install_en-US.exe'
$checksumType = 'sha256'
$silentArgs = '/S'
$validExitCodes = @(0)

Write-Debug "Detecting Locale..."
$supportedLocales = @{
	'ast'   = '447B455C4B1A0EF8773F27EA4E56C0A5DEE7E34773FC9A78842D0285EC279CAC';
	'bg'    = 'EF4CFA87A62F0B16DE3A56431CE8E718A2A2459B05F14518F4AE1AC824C04D17';
	'ca'    = '4E656EC9BD7FEC38201BDE777514D41411768A5D805212DD2B6ED53B006FB67D';
	'ca-XR' = 'D0E2F73577DF4481811ADE03714CAAA39FDF1D00DFF16D34A0C27935EF22BA39';
	'ca-XV' = 'C587798A1C5D65B4FB86970CE225B36F58D18CE4CEEC12846F0C27F7FA653988';
	'cs'    = '61698FBC02745A3206911EF0DB9CA4259829B07DE779BC636B16B92EDC5E6014';
	'da'    = '16098BA95876B1EC27BCF075496F4A9D99B4BF8B35B1A194C7A4034ECA074A43';
	'de'    = 'CFC7DFBBE8AB6F4ED8A1E6CE3759D26536CD5A8A200508F5C64E7838E7CC088D';
	'el'    = '66B3BE0574A6875F08AB5F88BACF7FC167BE0E63B8529758F8497AF58A10F59B';
	'en-GB' = 'E461295AFB9D903245C1427CCDC3B1F9A06D0C81F9F621DA6570EAC95530630A';
	'en-US' = '3B142B424BAF8D10A69F966D4FC314FB88B82341A1B9AB18F234F8922B764A0E';
	'es'    = '8FCA6A051121B2BE8475263858C443C901C1092B90EC73D09B7812D84EC4E662';
	'eu'    = '4A46A10D3184A14A68BE5BEA7CC988CE422D1BADA54BC3745B3EEB5A7F815558';
	'fi'    = '656654E2103673A62F5544A6E6E3148B042C2E1294D48149DF8288F3985EE6B1';
	'fr'    = '4F72A1FD2A2BD1AD6AFBEAE99EF21B21DFF7848512876EA76295790482649737';
	'gd'    = '3B44EFB1B46F0509509C697641593B959004F630C2AC35078586DFE5DB0AB1F4';
	'gl'    = '98B5931870321F571AF104423F3EF02117332BF201D518CFDBECEA9AE3643878';
	'he'    = '13B026C9466FC3FC8E9A0C35E1F6FAC73A6586F03CBAD8D1B855B580703BDB9A';
	'hi'    = 'DA9F387BC22BF5BEB1D68F30FFA8CB74160FFA299013F8FD26A83CA3994F8D7A';
	'hu'    = '7F59695768C1E41FCCAD8EE207104BDA9D89DE32409B6FE82170EF1D1FCBDE4B';
	'it'    = '090492354D66AFB88335E73283934C29D3CE81B38B045716FC169DBDBB0F7BC3';
	'ja'    = '8F6D136640C33BD0C0884BE2AB548274818A201BA932D1FECBD2F180EA30A321';
	'km'    = 'EFA8267ABF7C96F2CB364C0D9EEEF796A93667A6243EF75F90C48F02B05A85E9';
	'ko'    = '132C25836A8B8415ED94A3B6C2CFCC663951EB4AE0DE2B7D34C96300F373B458';
	'lt'    = '3F93BE31B42EE4FA698FA4966EA8B357353BE72B53180A0CB776EDCCF36F800A';
	'nb'    = 'AD1F01A7C609C009F05E4B3F823B7B418A8C931A6712E026E22E1A9D31B52076';
	'nl'    = '05235E9637A9DC39F172D3523EA4FA50555764F13789D53A1BF43D1A55F169BC';
	'pl'    = '634A9ED97A49D7D6CF8CAA0786C08842B17632EE7DC3660547A9B92A1D82B2EB';
	'pt'    = '3D2680A65C0F5DAAB20DC49E807455622865D12723D9D48C12A906CD94460093';
	'pt-BR' = '37A0E63C5602F3CD6C928E0FD4E346071086282CE4B1F13629DA6808C8BCB14F';
	'ru'    = '6518516DD1139F7C0A83FF2E35759DC8A15BBC6A36482E1E1EFF56F7D7AD9171';
	'sk'    = '96C3A9D3E043BE4F1D36A81D0D1CB43DAA5F2979FA27D8FC6B995CE9C895497E';
	'sl'    = 'B31226C804E732EB930B843EF58469D67512375D445EFE84538404398F31E3D5';
	'sr'    = '881EF89BB834EFA5E08EFA4C84D630CDD1333B2097BFD893E867A2AECA802896';
	'sv'    = '62A1A37E16DB59A5DE495BD53EC40DC9574B941702E75F4129C223C10B8F5254';
	'ta'    = 'E027F2DE3A1689FF960FE576BEBE855781C8AAD4E62F2C131E254403884C3B46';
	'th'    = '775311DA86CC440953502917B7E3344E02A41C1587792F4B6665E347472BA3C6';
	'tr'    = 'B90C689E13BDA558810A9E891F9E8BAFB00AE3F7D6C3063A61D7FD7A68477458';
	'vi'    = 'FABAF529B51DBD8331990FF55F2892CE6BBED4B9DAE83E85339E0AC4B6769349';
	'zh-CN' = '10821B1AD682ADB6E5DA9A971A9F9CBD3150DC0FA36596A72BC505842CBC5C6C';
	'zh-TW' = '7F2EAF1477780DCC378C55FC9665A157AD64C089C65A0D0804BF1B91DA466D60'
}

$pp = Get-PackageParameters
$locale = $pp["locale"]
if ($locale -ne $null -and $locale -ne '' -and $supportedLocales.ContainsKey($locale)) {
	Write-Host "Switching to $locale"
	$url = $url -replace 'en-US', $locale
	$checksum = $supportedLocales[$locale]
} else {
	$locale = (Get-Culture).Name
	if ($supportedLocales.ContainsKey($locale)) {
		Write-Host "Switching to $locale"
		$url = $url -replace 'en-US', $locale
		$checksum = $supportedLocales[$locale]
	} else {
		$locale = (Get-Culture).TwoLetterISOLanguageName
		if ($supportedLocales.ContainsKey($locale)) {
			Write-Host "Switching to $locale"
			$url = $url -replace 'en-US', $locale
			$checksum = $supportedLocales[$locale]
		} else {
			Write-Debug "Using default $locale"
			$checksum = $supportedLocales['en-US']
		}
	}
}

Install-ChocolateyPackage "$packageName" "$installerType" "$silentArgs" "$url" -checksumType $checksumType -checksum $checksum -validExitCodes $validExitCodes