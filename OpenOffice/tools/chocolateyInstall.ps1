$packageName = 'OpenOffice'
$installerType = 'EXE'
$url = 'https://downloads.sourceforge.net/project/openofficeorg.mirror/4.1.3/binaries/en-US/Apache_OpenOffice_4.1.3_Win_x86_install_en-US.exe'
$checksumType = 'sha256'
$silentArgs = '/S'
$validExitCodes = @(0)

Write-Debug "Detecting Locale..."
$supportedLocales = @{
	'el'    = '648AD09336F45A54AFE96618F2B2FFDC7F914E97DAE1B3C2FDBC240164F43214';
	'en-GB' = 'CA9C973E2898224D59B685F3E6A3B4BCC51A8B8533A3211CBE85049458F89F00';
	'en-US' = '27B961071574B40BE3160F59F0B3DA9C9FBB85D56F6CCDCDB1CED413E0890E22';
	'es'    = '905361C432536B470CDB28380C343DB8EE7A5E408233ACC848FCD606E848EF38';
	'eu'    = '0BBBB590A98852E7DBBEAB451C3D03872FA14AFED61266618CCF1767D4842B0E';
	'ca'    = 'CC301D8351CDCAE8A89591AF7D12EE1D143006477F1CFCB3F5D7504156049731';
	'ca-XR' = 'D1C664769A8067F66EDAA54FEB860C149E6EAA74F692E928081A8BDE3D4D1EDE';
	'ca-XV' = '91CEBDE0ADE041E3D6894C7455B86D9DA856536A49683763B5F66F1475C871CD';
	'cs'    = 'CE74AFD43A86F3F460B9C27969055DE76837146DBED83E04B0A2D915075EE15F';
	'ru'    = 'D9141D52A70BD9706CAFCFF688814DDA6A62184185F6B2A657AFC31E1B181CCA';
	'zh-CN' = 'BB487E27630123AA696F8AA0BD6F64C04CC16543796375C94E47F5ADC6B90D87';
	'zh-TW' = '6E315ABC19392F46C82B6EC20130B33B13EA943A0FFDDD3EEAD99F002A08A123';
	'vi'    = '8B1BFCF076F493B143DEDF78A0ACE507BB0E97A3DED5D6B92802A4FFB7E7D5B3';
	'ta'    = 'F19B709F7A30E25DEEADD6228403309080459704164FCBC1096D0BA0393F63AB';
	'th'    = '4F8A1DE07A7148A0D6B767A2A089FAAC67B606B8FBC059B61723AFEE452BC9F1';
	'tr'    = '4EE7322FEFB7BDE0FCFDC795C1BDED6756CE7E7F26382D450A3E8A5A791902CF';
	'sk'    = '6C5E393B163F4A9F6F916A1DC5229652CF43D9DB15B77FFFAB8A8D30E521F3C5';
	'sl'    = '8221F4223B4BB963D1624DAFBD959DD766B23604CC0E1DD01D410FECF9049EB3';
	'sr'    = '7EC158D22B5D35039081D04EFDE9A081CF580595B5F215C2E6239931277AB612';
	'sv'    = '1749F30ED8A736E736E1A540CA3547B1B5BED1D93B20904CF16A6DFE18A95F8E';
	'pl'    = '4D7B0ECA77887F4B411FA556C39DD3E7B2C4BC766DF77A295EE93745ED9A0095';
	'pt'    = '1FE0E7AC26B415AEDF615DA4EE3FC1CAEE2E63BC39238DFCE5F010DB84833DCA';
	'pt-BR' = 'DB4693AEAC576475EA192C66DE46D20342D81818400886E1FE54FEBF34C380BB';
	'nb'    = 'BED051CB8DC4B4CBB089BBECAF37996B89457DD5009F9C0C2D61AB465B586A59';
	'nl'    = '0C0B883777B340562B85CE5C690D8DF7DE4514A368C0DAA5BF28693CD6B65B7C';
	'lt'    = '31BA799001EB551FA3678BE1B197D3744707A401BA26C0A68C633A16B0C534C2';
	'km'    = 'FBE9AF2EC11976521F798A98063929EC499CC6347142D0389C5D2BB1C392CDDB';
	'ko'    = 'BD32B5B7A5FC0E3F4B8D8DD724D93401177D272232A9155CEAFA14CB305874AF';
	'ja'    = '9E33A8B40F86185C5FACD12298405E4ACE3DB098E4ED38607D92DA495BB946B1';
	'it'    = '458D41479AA96BA1DA0261B5275A69D3F7EBAE513A405FDDB2ED6CA7D42488AB';
	'he'    = 'B8AEEB6B11C90C6F2D3A0437771BB3FD9CF404F0422357D7376DDB9A41419B10';
	'hi'    = '6C0AE668E1438DC3370DA7D5F037AA797400AAE38DA8145F6D91B8BCD1311536';
	'hu'    = 'AEC44E3010D007FC457DE7FB28D6586099A54B9C1AEA74C32B824BAA662055AB';
	'gd'    = '283FBF110CE8FDC76B1F167439210978F87EA0052BB43A2C19449E0AD9417573';
	'gl'    = 'FC8A41A3DD14C8FA7C1E6BED22F5A41869733BBC4BC008D402615B7B81CEA698';
	'fi'    = '1A7EBC6C86C361C96AB057900536B3440699042402B35E9543D625C42ED043B6';
	'fr'    = '8114B6BE029AB31341FB5E4157D80A10DDE7A872627BFC33785F836E8E30E045';
	'da'    = 'C75F86A0366EDF1947F7EC5E0063B28FBC9575A48602BB8F696CFE39411356E8';
	'de'    = '9F2D6596D78ECADD10ACED4ED6575909965A9E7A90B6A8711B38D5BAD7FF1A05';
	'bg'    = 'F6DAF1C88AF2E51B8399DF6D6F31E8443FCF11A0293B540F08BC338080A096B2';
	'ast'   = 'B7C4BCD590CDAA65DDE7E749F727F9BA6B4B39F2490CD5D61BB980AE702F173E'
}

$locale = (Get-Culture).Name
if ($supportedLocales.ContainsKey($locale)) {
	Write-Host "Switching to $locale"
	$url = $url -replace 'en-US', $locale
	$checksum = $supportedLocales[$locale]
} else {
	$locale = (Get-Culture).TwoLetterISOLanguageName
	if ($supportedLocales.ContainsKey($locale)) {
		Write-Host "Switching to $locale"
		$url = $url -replace 'en-US', $locale
		$checksum = $supportedLocales[$locale]
	} else {
		Write-Debug "Using default $locale"
		$checksum = $supportedLocales['en-US']
	}
}

Install-ChocolateyPackage "$packageName" "$installerType" "$silentArgs" "$url" -checksumType $checksumType -checksum $checksum -validExitCodes $validExitCodes