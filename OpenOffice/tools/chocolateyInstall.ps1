$packageName = 'OpenOffice'
$installerType = 'EXE'
$url = 'https://downloads.sourceforge.net/project/openofficeorg.mirror/4.1.7/binaries/en-US/Apache_OpenOffice_4.1.7_Win_x86_install_en-US.exe'
$checksumType = 'sha256'
$silentArgs = '/S'
$validExitCodes = @(0)

Write-Debug "Detecting Locale..."
$supportedLocales = @{
	'ast'   = 'EF8F5709D51BF60C9AE31877CB55B8EDE6BED7F42FCD58DF8E7096C5165DB236';
	'bg'    = '0A35F69219EE6FA6C27EC6CD624F9435E9930542403FE0FADA072878DB9976BC';
	'ca'    = '4043353C8C43EAD5F7718297569EEF8B7B199A7E3A88BF6A41A97D547C4C60C5';
	'ca-XR' = '8F1D28CE454F2FCD290D6C66DF6D837027C231615348054CDF7ACC7A18FBEDB1';
	'ca-XV' = '4ECADD3532D99FE12D6DCD153BE0948D24BC6C0F79F8C6314EA9894AF7DBAB9E';
	'cs'    = '4BEAB5F3B9AFBC483782992F3F05F663D8899CB66CEBC772D5E5473C447A357A';
	'da'    = '55A05BC9BD3187BF42F310CF3890DC29CAE4347AF9365DEC63C277DA2720E992';
	'de'    = 'A16CC9765C230A17EB6F88776A08011A3E757CACBD659F3FFEE729350747CF72';
	'el'    = '4860BA57BF65B432D47B2E6818FFBD5A8B639AA1BE9F959BB540F0BAFD27CAC8';
	'en-GB' = '190C0848335560190C56BA473630D7ABB454743405B39B024702D771F55DA468';
	'en-US' = 'D0469863D5E6B8FBFA8EC432603F7B62899B100E65CBD94FE4251F9CE8AC1047';
	'es'    = '9A3A7893368F6496EFA8609AD64128D873481AAC697D732FF1B1D1C3920A5EE6';
	'eu'    = '127289FADA0A07193DAAF2EBD303826C51E123563963EA2006582DE83C75067D';
	'fi'    = '7B73F966F603EDEEAC87C954610C1E1D1206E4B6802D7E91C1E4E75CED192256';
	'fr'    = '64BC9B574D925810C2B05AA452338337A34F8E83A3F12BFC82BD7A64F058A981';
	'gd'    = 'D0FCB9C98BFC225C7F8C427941614B2B9375C855C13262B9235EB603AB794F50';
	'gl'    = 'FDAF66E4FBED2FD5EBFF32968855E76501F1A2A14C39AFF864DF4548019D7069';
	'he'    = '3BA6CC3F350F9A948BCD9B9BB34CCD738C773EEF8AAE4AE24116B1C25A62B463';
	'hi'    = '9664C391BB60E01BE33B84061CD4333FF308A24CBCBB4446C63D59D110BB082B';
	'hu'    = 'E60FB918363EF45135C814F7908EA2D52B2F772B199AC57114A3E1772E892099';
	'it'    = 'BA622A6C3F9CB9AE67979DD93C2FA81F3DDDDE75691D0B8D54A148A8F18781F8';
	'ja'    = '43B54BF8647D7437D966CBDD26BC03F0CF8E29B2F0597EB7BF66C814E2C835C6';
	'km'    = 'D9B169A226CB17385EAA2932D19CE14396360B7989F403694BA7C803FE78ABD0';
	'ko'    = 'DE23155B23EEB77AAAA3FE2E6C9D9EA4E91934F0843DD34B2CE5F7ABF22BD3CA';
	'lt'    = 'BF830F9A03E939E2492262C908A29635D2B1D88A33831989D20E1511AC784D12';
	'nb'    = '71C42A761ADA0596A38455D5AF7B0926DA0C2C300EEB22BF310FDBBEC43F1890';
	'nl'    = '4498518EFA661D3A6419A88FADB1E4DB7AEC089AA65DB7D80113BB9B531D80D7';
	'pl'    = 'F675687150E1D78F1E62E17B7E9BB42072E5231F71E726E65EDECA446D0CEA81';
	'pt'    = '1FE381A5DCFD3724C6D41410405210010CAC0127B37BD4F14ACD63B50B45C9C8';
	'pt-BR' = '374AFFC10E86996EB1FF536CDE16A79457C79672BEF31E4E760E34370ACC68EF';
	'ru'    = 'CB8AA1BFD3912885E5E265CF150C7D49329A1348A90EC553E7704B479BE114BB';
	'sk'    = 'D6F5969929D101765EB3DE553638C200206B64270264388A78CB03CCC3381CFE';
	'sl'    = 'F2644669E2EA6A20D9B6E211FF0F3F74F26A047C8FE40A06657A80332E6291D7';
	'sr'    = 'B6F5AA2AAD730C16109FF938EFAAB5E8EDBB8E369F4D5C3D42B85559B3191C4A';
	'sv'    = '13287737BC32C9597972C050BE391A074024812074C818B5439D3129C35C2698';
	'ta'    = '8BE54C9C6695C4290C1DE327B2BF0CAA9256ECDB6C0D025C1E3D5112009DD913';
	'th'    = 'E9EB7BAD6C9DDE5438B34539231EDBB9277A6B0ED79FFD6895DB5FB41870CA14';
	'tr'    = '8B66912E9B1152A825A983C7B20BDCE98D0E8FFDF192569267785554C2082A17';
	'vi'    = 'F44502C4491C152FA9C8175595FE75CE51114E85759620CA192BA003113A860E';
	'zh-CN' = '5C134193756837E6316AE1EE824CFB176BE1AC52E4CF714676B947E0CD075BBD';
	'zh-TW' = 'E5F9862C060316F2214FCD42B53C411E3726DF16E1CD2E074B4B5B4CEAA7C388'
}

$pp = Get-PackageParameters
$locale = $pp["locale"]
if ($locale -ne $null -and $locale -ne '' -and $supportedLocales.ContainsKey($locale)) {
	Write-Host "Switching to $locale"
	$url = $url -replace 'en-US', $locale
	$checksum = $supportedLocales[$locale]
} else {
	$locale = (Get-Culture).Name
	if ($supportedLocales.ContainsKey($locale)) {
		Write-Host "Switching to $locale"
		$url = $url -replace 'en-US', $locale
		$checksum = $supportedLocales[$locale]
	} else {
		$locale = (Get-Culture).TwoLetterISOLanguageName
		if ($supportedLocales.ContainsKey($locale)) {
			Write-Host "Switching to $locale"
			$url = $url -replace 'en-US', $locale
			$checksum = $supportedLocales[$locale]
		} else {
			Write-Debug "Using default $locale"
			$checksum = $supportedLocales['en-US']
		}
	}
}

Install-ChocolateyPackage "$packageName" "$installerType" "$silentArgs" "$url" -checksumType $checksumType -checksum $checksum -validExitCodes $validExitCodes