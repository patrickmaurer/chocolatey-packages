$packageName = 'OpenOffice'
$installerType = 'EXE'
$url = 'https://downloads.sourceforge.net/project/openofficeorg.mirror/4.1.5/binaries/en-US/Apache_OpenOffice_4.1.5_Win_x86_install_en-US.exe'
$checksumType = 'sha256'
$silentArgs = '/S'
$validExitCodes = @(0)

Write-Debug "Detecting Locale..."
$supportedLocales = @{
	'el'    = 'C8F56E162BF74A1043925D6738B78AF4CE582D8E51ECF3D60FAC8E4A93084258';
	'en-GB' = 'C415F21CFF5BEF4846FE4B2C8E327BFE8D6511B2BAEECC7CACD6EA2A3E779679';
	'en-US' = 'D226DDD08C4057E6215EAB49014A4B00C573182A4622D0B90B797C6420D565C8';
	'es'    = '6E72BA587BC794AD524A08018E08008EE1F565A53C534A23BE9EF27DFA1FA4E3';
	'eu'    = '80BEEAEC3BA62F20E7E3BDE5E7DCA6A091B36D916D06A81A28E8B22F4043A3FF';
	'ca'    = 'D05AFEC29DCE89AA5CF1A5B21BBE794EDF5AF60A57327A7FABE6A0D609E98892';
	'ca-XR' = 'F336BFAE9BD0AC62EBF4F50F2D013B512919F135F1BAAFCF69DDF5F56AE2650B';
	'ca-XV' = '31AF2DA5B540351CDB04E91C3FA224279DB85DE25F189C9B5740292D14B75877';
	'cs'    = '469700EEDC2951881963809ABAE3DFBF168D4305156D04444C2CB657698A6D61';
	'ru'    = '198884C087DC38C7C5E44E7CBEC268D4DA9A0260A1ECDD31B7DAA92DFE7FF1CC';
	'zh-CN' = '63AE32890468764B3EAC980ED40212BF4060452052FD942E1D992C2B3F4FD506';
	'zh-TW' = '833AF8150543265BAAA5D79767E37211DF0AAA171240CE07022AF44E07E07532';
	'vi'    = '4CD55ACB0BC47B557419EF349A6A17FEB4DEDCEB04B96312E09BA4CA9992EF73';
	'ta'    = 'F601334A3B6989A9E0FFBAA7A059A7A5A28A459DBEF3153D70DE2FF17177C6BA';
	'th'    = 'E1FBADE5E61285DFCFE726AE247D4F303A44639845B462308D91C7FD82405E98';
	'tr'    = '98CE5EB4B2D42001DF0CFACC687D823544BDA741B26C424DBAF98D3BAAAF33D8';
	'sk'    = 'B6CECB90C5F4F4342ADD83F582E29D7CEBDCA1A6C72C4E47540E1A938C5C7F77';
	'sl'    = 'C3A17FE880C1BC3EFDD720CF8551BB66F36FC1F5EB7A26943E2C2626FCA9A5FE';
	'sr'    = 'FD7B92FB68AB5DD743574F65DC10BEAA0421A0628B058EE1E3BC6A649405DB10';
	'sv'    = '45BD97EB4278F62C7BCC6A98A4EAFF6A4040AFCEE29700AADF3647F9E9F862E8';
	'pl'    = '20E71A0DAE38605144600811329380A1DC96E5FF63212669F1F3385B16446F9D';
	'pt'    = 'A216904820B05BE8CD35ACBC9E05E353464E4E16C5038D0F339A300C5C0C1744';
	'pt-BR' = '78A20E4021428072472E09CE0E457E20BAC9C1F4431981C61C42445398C782D2';
	'nb'    = '60BBC202233ED1E0F1E5EBE66E079D645D4A24A08952DAE5A968F9834FA74EE9';
	'nl'    = '15C7F26CB8B174F30BCDD9F4E70C0FA506F473E69149F235180691BD964BCBE2';
	'lt'    = '9D5403D1DB0333AFB9578A192A8691185C2408640186D898082E0C0FA63C5A41';
	'km'    = '02A023F39B2F1425E42761BD258C3E9EF663B4DEE0E9C3BC552A05C3C218989C';
	'ko'    = '7956C74DA8521B591D8F00E6C2694FCBA163BDC29F2063415314959FEDCF4D2E';
	'ja'    = 'A74AB224C24002BC04FC49FE6247584F8FF16EA000471053C5CD8EDA03F72908';
	'it'    = 'E16BBF5A30B64D66AFACBF29D56A96A05B85B7367650200ECBDB39DC602DF5E5';
	'he'    = 'F72684E7FC8A2DEA6B0A9567333C3745074B1DC101F81459DFD63C24F2A1B522';
	'hi'    = 'D3DF53266E756AF2F81CBA9C66E2CD425DA4CBEC4BB0B539F1AE6F9226F8F7C1';
	'hu'    = '110494FE2AF6629D93C0496CAC76F6BFE2FB21C141D2466A76939F75EC6C03A5';
	'gd'    = '0602B7F137F8F257F186503757AD0C05A306D316F903E8A5193F9CC242E16E8B';
	'gl'    = 'B3D9B4412FD775B4F4DC92C9F5A02CB6DF22D74B746D64131D38120E956D4B15';
	'fi'    = '4476AA3CBA586CDD04429E676AEB848F935B306B87418FDA271A03A361AB43E3';
	'fr'    = 'DC489BEAC3CC0CE86E1A1C1E65DB6B776999379AA6DE434EB8D2F9799AF708A9';
	'da'    = '4188E1CA738A654100A1FC39268D9D640BFBCDD41853DCE7BCAB501C5B1C2BF7';
	'de'    = '5F3446B1D8DABA6939429A50D06330A64FF061B1EC3233A9452564AF274E80EA';
	'bg'    = 'A5164700F3A6DA14CBE2153ABE968653841446BD53F4D433AC44575617E0F76D';
	'ast'   = '1F31BFC3C8CA02B1944B30517BD25DB74676CB5F37C187DB9F02BD11FAEFEF1A'
}

$pp = Get-PackageParameters
$locale = $pp["locale"]
if ($locale -ne $null -and $locale -ne '' -and $supportedLocales.ContainsKey($locale)) {
	Write-Host "Switching to $locale"
	$url = $url -replace 'en-US', $locale
	$checksum = $supportedLocales[$locale]
} else {
	$locale = (Get-Culture).Name
	if ($supportedLocales.ContainsKey($locale)) {
		Write-Host "Switching to $locale"
		$url = $url -replace 'en-US', $locale
		$checksum = $supportedLocales[$locale]
	} else {
		$locale = (Get-Culture).TwoLetterISOLanguageName
		if ($supportedLocales.ContainsKey($locale)) {
			Write-Host "Switching to $locale"
			$url = $url -replace 'en-US', $locale
			$checksum = $supportedLocales[$locale]
		} else {
			Write-Debug "Using default $locale"
			$checksum = $supportedLocales['en-US']
		}
	}
}

Install-ChocolateyPackage "$packageName" "$installerType" "$silentArgs" "$url" -checksumType $checksumType -checksum $checksum -validExitCodes $validExitCodes